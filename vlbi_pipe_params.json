{
    "global":{
        "project_code"      :  "er047a",
        "cwd"               :  "/users/jradcliffe5/scratch3/ER047/A",
        "vlbipipe_path"     :  "VLBI_pipeline",
        "job_manager"       :  "slurm",
        "HPC_project_code"  :  "",
        "default_partition" :  "Main",
        "default_walltime"  :  "10:00:00",
        "default_nodes"     :     1,
        "default_cpus"      :    24,
        "default_mpiprocs"  :    24,
        "default_nodetype"  :  "haswell_reg",
        "email_progress"    :  "jack.f.radcliffe@gmail.com",
        "mpicasapath"       :  "/data/exp_soft/pipelines/casa-prerelease-5.3.0-115.el7/bin/mpicasa",
        "casapath"          :  "/idia/software/containers/casa-stable-5.7.2-4.simg casa",
        "singularity"       :  true,
        "AOflag_command"    : ["/usr/local/bin/singularity exec /idia/software/containers/kern5-dev.simg aoflagger"],
        "wsclean_command"   : ["/Volumes/HD-LXU3/anaconda2/anaconda2/bin/wsclean"],
        "fitsidi_files"     : ["auto"],
        "fitsidi_path"      :  "raw_UV",
        "refant"            : ["EF","SR","O8","WB","T6","IR","TR","SV","BD","JB","ZC","DA","PI","KN","JM","UR","DE","CM","HH"],
        "fringe_finders"    : ["J0956+2515"],
        "phase_calibrators" : ["J1011+0106"],
        "targets"           : ["ER047628"],
        "do_parang"         :  true
    },
    "prepare_data":{
        "antab_file"        :  "auto",
        "flag_file"         :  "auto",
        "gaincurve":{
            "min_elevation" :   0.0,
            "max_elevation" :  90.0
        },
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "import_fitsidi":{
        "const_obs_id"      :  true,
        "scan_gap"          :  15.0,
        "remove_idi"        :  true,
        "make_backup"       :  true,
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "make_mms":{
        "separationaxis"    :  "auto",
        "numsubms"          :  "auto",
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "apriori_cal":{
        "correlator"        :  "default",
        "cal_weights"       :  true,
        "accor_options":{
            "solint"        :  "inf",
            "smooth"        :  true,
            "smoothtime"    : 180.0,
            "interp"        : "linear"
        },
        "do_observatory_flg": true,
        "make_gaincurve"    : true,
        "tsys_options":{
            "interp_flags"  :  true,
            "smooth"        :  true,
            "outlier_SN"    : [2.5,2.0],
            "jump_ident_pc" :  20,
            "interp"        : "linear,linear"
        },
        "ionex_options":{
        	"run"           :  false,
            "ionex_type"    : "final"
        },
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :   -1,
            "cpus"          :   -1,
            "mpiprocs"      :   -1,
            "nodetype"      :  "default"
        }
    },
    "init_flag":{
        "AO_flag_strategy"  :  "VLBI_pipeline/aoflag_strategies/faint_sources.rfis",
        "AO_flag_fields"    : ["ER047628","J0959+0243"],
        "flag_edge_chans":{
            "run"           :  true,
            "edge_chan_flag":  "5%"
        },
        "flag_autocorrs"    :  false,
        "quack_data":{
            "run"           :  true,
            "quack_time"    :  {"*":5.0},
            "quack_mode"    :  "beg"
        },
        "manual_flagging":{
            "run"           :  true,
            "flag_file"     :  "er047a_manualflags.txt"
        },
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :   -1,
            "cpus"          :   -1,
            "mpiprocs"      :   -1,
            "nodetype"      :  "default"
        }
    },
    "fit_autocorrs":{
        "select_calibrators": ["J0956+2515"],
        "interp_bad_solutions": true, 
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :   -1,
            "cpus"          :   -1,
            "mpiprocs"      :   -1,
            "nodetype"      :  "default"
        }
    },
    "sub_band_delay":{
        "select_calibrators": [["J0956+2515"]], 
        "time_range"        : [""],
        "sol_interval"      : ["60s"],
        "min_snr"           : [5.0],
        "fringe_niter"      :  300,
        "do_disp_delays"    :  true,
        "extensive_search"  :  false,
        "modify_sbd":{
            "run"           :  true,
            "spw_passmark"  :  0.5,
            "clip_badtimes" :  0.66
        },       
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :   -1,
            "cpus"          :   -1,
            "mpiprocs"      :   -1,
            "nodetype"      :  "default"
        }
    },
    "bandpass_cal":{
        "same_as_sbd_cal"   :  false,
        "select_calibrators": [["J0956+2515"]], 
        "time_range"        : [""],
        "sol_interval"      :  "inf",
        "min_snr"           :  3.0,
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :  -1,
            "cpus"          :  -1,
            "mpiprocs"      :  -1,
            "nodetype"      :  "default"
        }
    },
    "phase_referencing":{        
        "select_calibrators":  [["J1011+0106"],["J0959+0243"]],
        "cal_type"          : [[  "f",  "f",  "f",  "p",   "p", "ap", "ap", "ap",  "ap",   "p"],[  "f",  "f",  "f",  "p",   "p", "ap", "ap", "ap",  "ap",   "p"]],   
        "sol_interval"      : [["inf","inf","inf","inf","1min","inf","inf","inf","1min","1min"],["inf","inf","inf","inf","inf","inf","inf","inf","inf","inf"]],
        "combine"           : [["spw","spw",   "",   "",    "","spw",   "",   "", "spw",    ""],["spw","spw",   "",   "",    "spw","spw",   "spw",   "spw", "spw",    "spw"]],
        "interp_flagged"    : [[ true, true, true, true,  true, true, true, true,  true,  true],[ true, true, true, true,  true, true, true, true,  true,  true]],
        "pass_ants"         : [[],["JB"]],
        "do_disp_delays"    : true,
        "cal_weights"       : true,
        "imager"            :  "tclean",
        "fringe_niter"      :  300,
        "min_snr"           :  5.0,
        "imaging_params"    :  "auto",
        "masking"           :  "peak",
        "thresholding"      :  "offset",
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "apply_target":{
        "statistical_reweigh":{
                "run": false,
                "timebin"   :  "10s",
                "chanbin"   :  "spw",
                "statalg"   :  "classic",
                "fitspw"    :  ""
        },
        "weigh_by_ants":{
                "run": true
        },
        "backup_caltables"  : true,
        "image_target"      : true,
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "prepare_apply_all":{
        "target_path"       : "/users/jradcliffe5/vlbi/wide-field_VLBI/ER047/A/raw_UV/",
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default"
        }
    },
    "apply_to_all":{  
        "target_outpath"    : "/users/jradcliffe5/vlbi/wide-field_VLBI/ER047/A/calibrated_v1",
        "tar_output"        : true,
        "tar_ms_only"       : true,
        "pbcor":{
            "run"           : true,
            "implementation": "uvcorr",
            "vex_file"      : "",
            "pointing_centre"  : ["10h00m25.0000000s","+2d33m00.000000s"],
            "backup_caltables"  : true
        },
        "image_target":{
            "run"           : true,
            "imsize"        : [1024,1024]
        },
        "hpc_options":{
            "partition"     :  "default",
            "walltime"      :  "default",
            "nodes"         :    -1,
            "cpus"          :    -1,
            "mpiprocs"      :    -1,
            "nodetype"      :  "default",
            "max_jobs"      : 24
        }
    }
}
